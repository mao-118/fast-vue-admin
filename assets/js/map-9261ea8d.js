var e=Object.defineProperty,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(a,o,t)=>o in a?e(a,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[o]=t;import"https://webapi.amap.com/maps?v=2.0&key=596002c0d52b6b4360a70ecbfb4c692d";import{a as i}from"./index-18d41a5c.js";import{_ as l,b as n,r as s,C as c,c as p,d,e as m,w as u,p as v,g,E as f,i as b,o as w,t as y}from"./index-cce20ba6.js";const h={class:"app-container"},M={class:"search-box"},x=["title"],k=["title"],A={style:{color:"#0082e5","font-size":"14px","font-weight":"700",height:"20px","line-height":"20px"}},O={style:{"font-size":"12px",color:"#8e8e8e",height:"20px","line-height":"20px"}},j=(e=>(v("data-v-1a817307"),e=e(),g(),e))((()=>d("div",{id:"container"},null,-1)));var P=l({setup(e){const l=n(""),v=n(),g=s({viewMap:null,marker:null,geocoder:null,geolocation:null}),P=e=>{_(e.lnglat),z(e.lnglat)},_=e=>{g.marker.setPosition([e.lng,e.lat])},z=e=>{g.geocoder.getAddress([e.lng,e.lat],((e,a)=>{if("complete"===e&&"OK"===a.info&&a&&a.regeocode){const e=a.regeocode.formattedAddress;g.marker.setTitle(e)}}))},T=async(e,l)=>{const{data:n}=await i.get("https://restapi.amap.com/v3/place/text",{params:{keywords:e,city:"杭州",key:"1a68b5f1bf437db3754cc1c9256c8433",output:"json",extensions:"all",city_limit:!1}});var s=[];n.pois&&(s=n.pois.map((e=>((e,i)=>{for(var l in i||(i={}))o.call(i,l)&&r(e,l,i[l]);if(a)for(var l of a(i))t.call(i,l)&&r(e,l,i[l]);return e})({value:e.pname+e.cityname+(e.adname===e.address?e.adname:e.adname+e.address)+e.name,newAddress:e.pname+e.cityname+e.adname},e)))),0===s.length&&(s=[{value:"暂未搜索到该地点信息",isResultLengthZero:!0}]),l(s),v.value.focus()},B=e=>{if(e.isResultLengthZero)return void(l.value="");g.viewMap.setZoom(16);const a=e.location.split(",");g.marker.setPosition([a[0],a[1]]),g.marker.setTitle(e.value),g.viewMap.setCenter([a[0],a[1]])},C=e=>{_(e.position),z(e.position)},G=e=>{f.error("定位失败")};return c((()=>{g.viewMap=new AMap.Map("container",{zoom:11,resizeEnable:!0,viewMode:"3D"}),g.marker=new AMap.Marker({position:[116.397428,39.90923],title:""}),AMap.plugin(["AMap.Geocoder","AMap.Geolocation","AMap.ToolBar"],(()=>{g.geocoder=new AMap.Geocoder({radius:1e3,extensions:"all"});var e=new AMap.ToolBar({position:"LB"});g.viewMap.addControl(e),g.geolocation=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB",showMarker:!1}),g.geolocation.on("complete",C),g.geolocation.on("error",G),g.viewMap.addControl(g.geolocation)})),g.viewMap.on("click",P),g.viewMap.add(g.marker)})),(e,a)=>{const o=b("el-autocomplete");return w(),p("div",h,[d("div",M,[m(o,{ref_key:"elautocomplete",ref:v,"trigger-on-focus":!1,"prefix-icon":"Search",clearable:"",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=e=>l.value=e),placeholder:"请输入地名关键字","fetch-suggestions":T,onSelect:B},{default:u((({item:e})=>[e.isResultLengthZero?(w(),p("div",{key:0,title:e.value,style:{"text-align":"center",color:"red"}},y(e.value),9,x)):(w(),p("div",{key:1,style:{"margin-bottom":"10px"},title:e.value},[d("div",A,y(e.name),1),d("div",O,y(e.newAddress),1)],8,k))])),_:1},8,["modelValue"])]),j])}}},[["__scopeId","data-v-1a817307"]]);export{P as default};
