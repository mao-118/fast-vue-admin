import{i as e,r as a,aP as s,ai as l,G as t,c as o,b as r,R as c,S as n,aV as u,q as d,l as i,w as p,n as m,aQ as f,aZ as x,g as v,f as g,E as b}from"./index-1f5573ce.js";import{E as _}from"./el-divider-e967bda9.js";import{E as j,a as w}from"./el-form-item-81cf2eda.js";import{E as h}from"./el-col-d2729a03.js";import"./castArray-8e49a64e.js";const k={class:"app-container"},y=v(" 连接状态： "),E=v("发送"),V=v("聊天记录"),q={class:"msg-box"},R={class:"msg-content"},S={class:"msg-text"},A={setup(v){const A=e([]),C=a(null),G=e({text:""}),P=e({text:[{required:!0,message:"输入的内容不能为空",trigger:"blur"}]}),Q=()=>{C.value.validate((e=>{e?(B(G.text),b.success("发送成功")):console.log(e)}))};let U=null;const W=a(0),Z=e([{color:"text-purple-500",text:"建立连接中..."},{color:"text-green-500",text:"连接成功"},{color:"text-red-500",text:"连接失败"},{color:"text-purple-500",text:"连接关闭"}]),z=e=>{W.value=1},B=e=>{U.send(e),A.push(e)},D=e=>{A.push(e.data)},F=e=>{W.value=2,console.log("error",e),b.error("连接异常，请尝试刷新页面")},H=e=>{W.value=3,console.log("close",e)};return U=new WebSocket("wss://javascript.info/article/websocket/chat/ws"),U.onopen=z,U.onmessage=D,U.onerror=F,U.onclose=H,s((()=>{U.close()})),(e,a)=>{const s=l,v=h,b=j,U=t,z=w,B=_;return g(),o("div",k,[r("div",null,[y,r("span",{class:c(n(Z)[W.value].color)},u(n(Z)[W.value].text),3)]),d(z,{ref_key:"formRef",ref:C,model:n(G),rules:n(P),"label-width":"80px"},{default:i((()=>[d(b,{label:"输入内容",prop:"text"},{default:i((()=>[d(v,{span:5},{default:i((()=>[d(s,{modelValue:n(G).text,"onUpdate:modelValue":a[0]||(a[0]=e=>n(G).text=e)},null,8,["modelValue"])])),_:1})])),_:1}),d(b,null,{default:i((()=>[d(U,{type:"primary",onClick:Q},{default:i((()=>[E])),_:1})])),_:1})])),_:1},8,["model","rules"]),d(B,null,{default:i((()=>[V])),_:1}),p(r("div",q,[(g(!0),o(f,null,x(n(A),((e,a)=>(g(),o("div",{key:a,class:c([{pt:a%2==0},"msg-item"])},[r("div",R,[r("div",S,u(e),1)])],2)))),128))],512),[[m,n(A).length]])])}}};export{A as default};
