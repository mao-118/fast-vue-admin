var x=Object.defineProperty;var g=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var v=(n,a,s)=>a in n?x(n,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[a]=s,f=(n,a)=>{for(var s in a||(a={}))B.call(a,s)&&v(n,s,a[s]);if(g)for(var s of g(a))P.call(a,s)&&v(n,s,a[s]);return n};import"https://webapi.amap.com/maps?v=2.0&key=596002c0d52b6b4360a70ecbfb4c692d";import{a as C}from"./index.a8d3a918.js";import{_ as S,b as h,r as z,y as E,c as T,o as p,d,e as c,f as V,w as G,p as L,i as R,E as Z,t as u}from"./index.d5726bb6.js";const O=n=>(L("data-v-18fc67f0"),n=n(),R(),n),j={class:"app-container"},D={class:"search-box"},H=["title"],I=["title"],N={style:{color:"#0082e5","font-size":"14px","font-weight":"700",height:"20px","line-height":"20px"}},K={style:{"font-size":"12px",color:"#8e8e8e",height:"20px","line-height":"20px"}},U=O(()=>c("div",{id:"container"},null,-1)),q={setup(n){const a=h(""),s=h(),o=z({viewMap:null,marker:null,geocoder:null,geolocation:null}),M=()=>{o.viewMap=new AMap.Map("container",{zoom:11,resizeEnable:!0,viewMode:"3D"}),o.marker=new AMap.Marker({position:[116.397428,39.90923],title:""}),AMap.plugin(["AMap.Geocoder","AMap.Geolocation","AMap.ToolBar"],()=>{o.geocoder=new AMap.Geocoder({radius:1e3,extensions:"all"});var e=new AMap.ToolBar({position:"LB"});o.viewMap.addControl(e),o.geolocation=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new AMap.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB",showMarker:!1}),o.geolocation.on("complete",A),o.geolocation.on("error",b),o.viewMap.addControl(o.geolocation)}),o.viewMap.on("click",w),o.viewMap.add(o.marker)},w=e=>{m(e.lnglat),_(e.lnglat)},m=e=>{o.marker.setPosition([e.lng,e.lat])},_=e=>{o.geocoder.getAddress([e.lng,e.lat],(r,i)=>{if(r==="complete"&&i.info==="OK"&&i&&i.regeocode){const t=i.regeocode.formattedAddress;o.marker.setTitle(t)}})},y=async(e,r)=>{const{data:i}=await C.get("https://restapi.amap.com/v3/place/text",{params:{keywords:e,city:"\u676D\u5DDE",key:"1a68b5f1bf437db3754cc1c9256c8433",output:"json",extensions:"all",city_limit:!1}});var t=[];i.pois&&(t=i.pois.map(l=>f({value:l.pname+l.cityname+(l.adname===l.address?l.adname:l.adname+l.address)+l.name,newAddress:l.pname+l.cityname+l.adname},l))),t.length===0&&(t=[{value:"\u6682\u672A\u641C\u7D22\u5230\u8BE5\u5730\u70B9\u4FE1\u606F",isResultLengthZero:!0}]),r(t),s.value.focus()},k=e=>{if(e.isResultLengthZero){a.value="";return}o.viewMap.setZoom(16);const r=e.location.split(",");o.marker.setPosition([r[0],r[1]]),o.marker.setTitle(e.value),o.viewMap.setCenter([r[0],r[1]])},A=e=>{m(e.position),_(e.position)},b=e=>{Z.error("\u5B9A\u4F4D\u5931\u8D25")};return E(()=>{M()}),(e,r)=>{const i=T("el-autocomplete");return p(),d("div",j,[c("div",D,[V(i,{ref_key:"elautocomplete",ref:s,"trigger-on-focus":!1,"prefix-icon":"Search",clearable:"",modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=t=>a.value=t),placeholder:"\u8BF7\u8F93\u5165\u5730\u540D\u5173\u952E\u5B57","fetch-suggestions":y,onSelect:k},{default:G(({item:t})=>[t.isResultLengthZero?(p(),d("div",{key:0,title:t.value,style:{"text-align":"center",color:"red"}},u(t.value),9,H)):(p(),d("div",{key:1,style:{"margin-bottom":"10px"},title:t.value},[c("div",N,u(t.name),1),c("div",K,u(t.newAddress),1)],8,I))]),_:1},8,["modelValue"])]),U])}}};var X=S(q,[["__scopeId","data-v-18fc67f0"]]);export{X as default};
